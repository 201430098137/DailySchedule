# Auto Test 的企划

## 目的 

使用 qemu 通过 加载 制作好的镜像 的方式 

自动测试 内核 + 应用 程序 

得出 一个报告结果

um...

## 技术选型 

我认为 shell python rust 都可以 

因为 shell 最方便 linux 通用 不需要依赖

python 方便包装、一些有趣的工具 可以增加一些能力

rust um.. 

这有什么的 就是想用 想干什么事跟语言有什么关系、又不是计算类的程序、

## 草案

我们应该先定义 一个 行为 、

我想怎么测试 、 怎么方便测试 

我想在 host 机 (也就是我们的linux) 上 通过 一个简单的 方式 去 测试 、

是不是意味着 我们电脑上 要有 qemu、他是虚拟机阿、没它怎么测、 产生出 需要思考的 问题 、qemu 的安装与配置 对这件事情的影响 有多少

我们想要 测试 这事情 不简单 

因为 我们必须要知道 一些 事情 、比如 输入的东西在哪里、(目前因该是我们的镜像)

把 镜像放入 虚拟机 运行 、运行起来后 、我们还要 知道 测试程序 在那里、如何运行、这些东西比较不确定、因为 会各式各样、不一而足、有两种思考方式、

一个 制定统一规则 、按规矩、摆放与启动、考验规则制定的合理性与完备性、需要经验度、

二是 提供镜像时、也提供一份 自定义启动方式、我们依据这个 进行测试 、um....

这个是启动 路径 应该 、

我们要做的应该是 给出 启动 方法 、并把启动和运行 状况 收集 起来

还要 保证 不会宕机 用户程序 崩了 可以继续 、系统崩了 也可继续

这是 容灾恢复 ？？ 


最后 等着 开开心心的 获得 结果 

um......    好好考虑下 



## 分析 

根据老师的初级要求 

在 rCore 上 基于 qemu 自动测试 脚本 

首先 确定 这件事情的 Input

Input:

    1. OVMF.fd
    2. boot && kernel 
    3. x86_64.qcow2


host 主机 启动 脚本 

生成   
1. OVMF.fd 脚本
2. 生成 boot 和 kernel 的 脚本
3. 生成 文件系统的脚本


## 设计 

部署 的 环境 

Input : Image

Execute : Qemu

Output : Result File ?

生产 的 使用 

UserAPP ： 用户 程序 

Kernel ： 内核 程序 

Root ： 引导程序


## 解释
用户程序、内核 程序 、引导程序 编译制作 需要 环境 

而配置 环境 是 大问题 、

所以 使用 docker 配置 一个 成熟 的 环境 来 编译 

考虑到 有可能 同时测试多个 不同版版本的测试

为了增加隔离性 、把qemu 也放到docker 上运行、、这时的测试只看container 就可以了